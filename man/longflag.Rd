% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/longflag.R
\name{longflag}
\alias{longflag}
\title{Flag meaningful changes across repeated timepoints within subjects}
\usage{
longflag(
  data,
  id,
  time,
  value,
  threshold,
  method = c("first_last", "mean_change", "all_timepoints")
)
}
\arguments{
\item{data}{A long-format data frame or tibble containing repeated observations.}

\item{id}{A string supplying the column name representing unique subject IDs.}

\item{time}{A string supplying the column name representing the ordered timepoints.}

\item{value}{A string supplying the column name of the numeric variable to evaluate.}

\item{threshold}{Numeric cutoff defining what magnitude of change should be flagged.}

\item{method}{One of `"first_last"`, `"mean_change"`, or `"all_timepoints"`.
Determines how change is calculated. See details.}
}
\value{
A tibble summarizing observed changes:

If `method = "first_last"` or `"mean_change"`:
  * one row per subject
  * columns: ID, change, flagged (plus method-specific summary columns)

If `method = "all_timepoints"`:
  * one row per subject-time comparison
  * columns: ID, from_time, to_time, change, flagged
}
\description{
`longflag()` identifies changes in a repeated-measures dataset based on
selected methods. The function takes a long-format dataset and evaluates
whether meaningful change has occurred using one of three approaches:
}
\details{
* `"first_last"` – change = last value – first value
* `"mean_change"` – change = mean(value) – first value
* `"all_timepoints"` – returns a row-wise change between consecutive timepoints


The change logic depends on the chosen method:

**Method `"first_last"`**
Produces one row per subject. Change is defined as:
\deqn{change = last(value) - first(value)}

**Method `"mean_change"`**
Produces one row per subject. Change is defined as:
\deqn{change = mean(value) - first(value)}

**Method `"all_timepoints"`**
Produces multiple rows per subject, comparing each timepoint to the previous one.
For the first timepoint, no previous comparison exists, so `NA` is returned by design.

A subject or timepoint pair is flagged when the magnitude of change meets or exceeds
`threshold`.
}
\examples{
## Example dataset
test_data <- data.frame(
  Person = rep(1:3, each = 3),
  Time = rep(c(1, 2, 3), 3),
  Score = c(10, 12, 15,   20, 20, 22,   5, 5, 5)
)

## Example 1: Compare only first and last values
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 3,
  method = "first_last"
)

## Example 2: Compare mean value to first value
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 2,
  method = "mean_change"
)

## Example 3: Compare consecutive timepoints
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 4,
  method = "all_timepoints"
)
}
