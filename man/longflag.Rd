% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/longflag.R
\name{longflag}
\alias{longflag}
\title{Flag meaningful changes across repeated timepoints within subjects}
\usage{
longflag(
  data,
  id,
  time,
  value,
  threshold,
  method = c("first_last", "mean_change", "all_timepoints")
)
}
\arguments{
\item{data}{A long-format data frame or tibble containing repeated observations.}

\item{id}{A string supplying the column name representing unique subject IDs.}

\item{time}{A string supplying the column name representing the ordered timepoints.}

\item{value}{A string supplying the column name of the numeric variable to evaluate.}

\item{threshold}{User-defined numeric cutoff defining what magnitude of change should be flagged.}

\item{method}{One of \code{first_last}, \code{mean_change}, or \code{all_timepoints}.
Determines how change is calculated. See details.}
}
\value{
A tibble summarizing observed changes:

If \code{method = first_last} or \code{mean_change}:
\itemize{
\item One row per subject.
\item Columns: \code{ID}, \code{change}, \code{flagged} (plus method-specific summary columns).
\item Column \code{flagged} being a logical indicator corresponding to the user-defined threshold.}

If \code{method = all_timepoints}:
\itemize{
\item One row per subject-time comparison.
\item Produces multiple rows per subject, comparing each timepoint to the previous one.
\item For the first timepoint, no previous comparison exists, so \code{NA} is returned by design.
\item Columns: \code{ID}, \code{from_time}, \code{to_time}, \code{change}, \code{flagged}}
}
\description{
\code{longflag()} identifies changes in a repeated-measures dataset based on
selected methods. The function takes a long-format dataset and evaluates
whether a meaningful change has occurred using one of three approaches.
}
\details{
The meaningful change logic depends on the chosen method:

\itemize{
  \item \code{first_last}: Change is defined as:
\deqn{change = \text{last(value)} - \text{first(value)}}
  \item \code{mean_change}: Mean of all stepwise changes.
  \item \code{all_timepoints}: Returns a row-wise change between consecutive timepoints.}


A subject or timepoint pair is flagged when the magnitude of change meets or exceeds a user-defined \code{threshold}.
}
\examples{
# Example dataset
test_data <- data.frame(
  Person = rep(1:3, each = 3),
  Time = rep(c(1, 2, 3), 3),
  Score = c(10, 12, 15,   20, 20, 22,   5, 5, 5)
)

# Example 1: Compare only first and last values
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 3,
  method = "first_last"
)

# Example 2: Compare mean of consecutive stepwise changes
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 2,
  method = "mean_change"
)

# Example 3: Compare consecutive timepoints
longflag(
  data = test_data,
  id = "Person",
  time = "Time",
  value = "Score",
  threshold = 4,
  method = "all_timepoints"
)

}
